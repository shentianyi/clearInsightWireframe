swagger: '2.0'
info:
  version: 0.0.11
  title: clearinsight web service api
host: '112.124.28.10:8001'
basePath: /api/v2
definitions:
  enum_object:
    type: object
    required:
      - id
      - name
    properties:
      id:
        type: integer
        description: the id of the enum item
      name:
        type: string
        description: the name of the enum item
  user_info:
    description: more detailed user info than brief user info
    type: object
    properties:
      basic_info:
        $ref: '#/definitions/brief_user_info'
  department_member:
    type: object
    properties:
      user:
        $ref: '#/definitions/brief_user_info'
      is_manager:
        type: boolean
        description: is manager of the current department
  alert_handle_type:
    type: object
    description: 'the alert message handle type, if auto_read, server will mark readed auto, if manual_read, user should mark read on ui'
    properties:
      id:
        type: integer
        description: 'alert type id,  100 is manualread, 200 is autoread'
      name:
        type: string
  alert_head:
    type: object
    properties:
      alert_id:
        type: integer
      alert_type:
        type: integer
        description: "alert type has 4: tasks(value is:100),kpi_follow(200),add_to_discussion(310),add_to_department(320).and 310&320 are system alert"
      alert_text:
        type: string
      created_at:
        type: date
        description: utc time
      sender:
        type: string
        
  base_alert_data:
    type: object
    properties:
      id:
        type: integer
        description: id of the object
        
  task_alert_data:
    type: object
    properties:
      id:
        type: integer
        description: id of the object 
      due_flag:
        type: boolean
        description: weather is task is finished by user

  task_alert:
    type: object
    properties:
      head:
        $ref: '#/definitions/alert_head'
      unread:
        type: boolean
      handle_type:
        $ref: '#/definitions/alert_handle_type'
      data:
        $ref: '#/definitions/task_alert_data'
        
  system_alert:
    type: object
    properties:
      head:
        $ref: '#/definitions/alert_head'
      unread:
        type: boolean
      handle_type:
        $ref: '#/definitions/alert_handle_type'
      data:
        description: when alert_type is 310(add to discussion), id is discussion_id ,when 410, id is department id
        $ref: '#/definitions/base_alert_data'
  kpi_follow_alert:
    type: object
    properties:
      head:
        $ref: '#/definitions/alert_head'
      unread:
        type: boolean
      handle_type:
        $ref: '#/definitions/alert_handle_type'
      data:
        description: id is follow id
        $ref: '#/definitions/base_alert_data'
  unread_alert:
    type: object
    properties:
      alert_type:
        type: string
        description: the alert type
        enum:
          - task
          - kpi_follow
          - system
          - add_to_discussion
          - add_to_department
      count:
        type: number
        description: unread count
  brief_entry_task:
    type: object
    properties:
      id:
        type: integer
        description: the task id
      title:
        type: string
        description: task title
      due_flag:
        type: boolean
        description: indicate whether there is task item on this user has due
      to_due_at:
        type: date
        description: utc date of when should be dued
      dued_at:
        type: date
        description: utc date of when has been dued
      assigner:
        description: the assigner(user) of the task
        $ref: '#/definitions/brief_user_info'
      kpi:
        $ref: '#/definitions/kpi'
      department:
        $ref: '#/definitions/department'
  brief_entry_task_item:
    type: object
    properties:
      task_item_id:
        type: integer
        description: the task item id
      due_flag:
        type: boolean
        description: indicate whether there is task item on this user has due
      to_due_at:
        type: date
        description: utc date of when should be dued
      dued_at:
        type: date
        description: utc date of when has been dued
      status:
        type: string
        description: the status string of the task
      status_value:
        type: integer
        description: the status value of the task, int values of planned is 100,due_in_plan is 200, due_after_plan is 300
        enum:
          - planned
          - due_in_plan
          - due_after_plan
      kpi:
        $ref: '#/definitions/kpi'
      department:
        $ref: '#/definitions/department'
  task:
    type: object
    properties:
      taks_id:
        type: integer
        description: the task id
      user_id:
        type: integer
        description: the user id
      kpi:
        $ref: '#/definitions/kpi'
      department:
        $ref: '#/definitions/department'
      due_flag:
        type: boolean
        description: indicate whether there is task item on this user has due
      assignments:
        type: array
        items:
          $ref: '#/definitions/assignment'
  task_item:
    type: object
    properties:
      task_item_id:
        type: string
        description: the task item id
      task:
        $ref: '#/definitions/task'
        description: the task id
      deadline:
        type: string
        format: date-time
        description: the dealine to finish the task item.
      is_due:
        type: boolean
        description: indicate whether the task item on this user has due
      status:
        type: string
        description: the status of the task
        enum:
          - planned
          - due
          - finish_in_plan
          - finish_after_due
  discussion_comments:
    type: object
    properties:
      content:
        type: string
        description: the text comment
      attachment_ids:
        type: array
        items:
          type: integer
          description: the attachments id
  attachment:
    type: object
    properties:
      type:
        type: string
        description: image or snapshot
      value:
        type: object
        description: the evidence
  image_attachs:
    type: object
    properties:
      image:
        type: image
        description: the image attachment
  comment:
    type: object
    properties:
      id:
        type: string
        description: the id of the comment
      content:
        type: string
        description: the text comment
      attachments:
        description: 'the collection of evidence (picture, video, snapshot)'
        type: array
        items:
          $ref: '#/definitions/attachment'
      creator:
        description: the creator of the comment
        type: string
      created_at:
        description: the create date on UTC format
        type: string
        format: date-time
  discussion:
    type: object
    properties:
      id:
        type: string
        description: the id of the discussion
      title:
        type: string
        description: "the discussion's title"
      content:
        type: string
        description: "the discussion's content"
      kpi_id:
        type: string
      department_id:
        type: string
      members:
        type: array
        items:
          type: string
      creator:
        type: string
        description: the nick name of the creator
      created_at:
        type: string
        description: the creation date of the discussion under UTC format
      closed_at:
        type: string
        description: the close date of the discussion under UTC format
      status:
        type: string
        description: the status of the discussion
      status_value:
        type: string
        description: the status value of the discussion
        enum:
          - open
          - closed
      manageable:
        type: boolean
        description: the user can manage the discussion
  users_on_discussion:
    type: object
    properties:
      member_id:
        type: integer
        description: the discussion member record id
      user:
        $ref: '#/definitions/brief_user_info'
      removeable:
        type: boolean
        description: can remove the member
  discussion_members:
    type: object
    properties:
      id:
        type: integer
        description: discussion id
      members:
        type: array
        items:
          type: integer
        description: array of user id of the members
  data_input:
    type: object
    properties:
      kpi_id:
        type: integer
      department_id:
        type: integer
      entry_id:
        type: string
        description: 'entry id, can be blank, if update the entry data, it should not be blank'
      data:
        $ref: '#/definitions/data_entry_with_attributes'
  data_entry:
    type: object
    properties:
      value:
        type: number
        format: float
      time:
        type: string
        format: date-time
        description: UTC time format
  data_entry_with_attributes:
    type: object
    properties:
      value:
        type: number
        format: float
      time:
        type: string
        format: date-time
        description: UTC time format
      attributes:
        type: array
        items:
          $ref: '#/definitions/attribute_value'
        description: the attributes collection
  snapshot:
    type: object
    properties:
      alert_text:
        type: string
        description: the followed kpi alert
      current_value_text:
        type: string
      upper_boundary_text:
        type: string
      lower_boundary_text:
        type: string
      chart_data:
        type: array
        description: snapshot chart data
        items:
          $ref: '#/definitions/chart_data'
      created_at:
        type: string
        format: date-time
        description: creation time on UTC format
      creator:
        $ref: '#/definitions/brief_user_info'
        description: "the creater's information"
  kpi_details:
    type: object
    properties:
      kpi:
        $ref: '#/definitions/kpi'
      alert_text:
        type: string
      current_value:
        type: number
        format: float
      frequency:
        type: string
        description: 'frequency in time span like hour, day, week'
        enum:
          - hour
          - day
          - week
          - month
          - quater
          - year
      calculate_method:
        type: string
        description: the calculate method the system supports
        enum:
          - average
          - accumulate
      from_time:
        type: string
        format: date-time
      end_time:
        type: string
        format: date-time
      department:
        $ref: '#/definitions/department'
      data_entries:
        type: array
        description: sorted by time
        items:
          $ref: '#/definitions/data_entry'
  chart_data:
    type: object
    properties:
      date_time:
        type: dateTime
        description: utc date
      value:
        type: number
      value_text:
        type: string
      upper_boundary:
        type: number
      lower_boundary:
        type: number
      upper_boundary_text:
        type: string
      lower_boundary_text:
        type: string
      over_upper_boundary:
        type: boolean
      over_lower_boundary:
        type: boolean
  chart_aggregate_data:
    type: object
    required:
      - attributes
      - value
      - value_text
      - percentage
      - percentage_text
    properties:
      attributes:
        type: array
        description: attribute
        items:
          $ref: '#/definitions/attribute_value'
      value:
        type: number
        description: value
      value_text:
        type: string
        description: value text
      percentage:
        type: number
        description: 'percentage, round(2), if percentage is 98.87%, percentage number is 98.87'
      percentage_text:
        type: string
        description: 'percentage, if percentage is 98.87%, percentage text is 98.87%'
  followed_kpi:
    type: object
    required:
      - follow_id
      - last_updated_at
      - user
      - kpi
      - department
      - lower_boundary
      - upper_boundary
      - current_value
      - lower_boundary_text
      - upper_boundary_text
      - current_value_text
      - over_lower_boundary
      - over_upper_boundary
    properties:
      follow_id:
        type: integer
        description: user follow kpi id
      last_updated_at:
        type: date
        description: last updated at utc date time
      user:
        $ref: '#/definitions/brief_user_info'
      kpi:
        $ref: '#/definitions/kpi'
      department:
        $ref: '#/definitions/department'
      lower_boundary:
        type: number
        format: float
      upper_boundary:
        type: number
        format: float
      current_value:
        type: number
        format: float
      lower_boundary_text:
        type: string
      upper_boundary_text:
        type: string
      current_value_text:
        type: string
      over_lower_boundary:
        type: boolean
      over_upper_boundary:
        type: boolean
  notify:
    type: object
    required:
      - message
    properties:
      message:
        type: string
        description: notify message body
  followed_kpi_notify:
    type: object
    required:
      - result_code
      - messages
      - notify
    properties:
      result_code:
        type: interger
        description: '0 for no notify, 1 for has notify'
      messages:
        types: Array
        description: 'get notify result messages, like fail or success'
      notify:
        $ref: '#/definitions/notify'
  created_kpi:
    type: object
    required:
      - user
      - kpi
    properties:
      user:
        $ref: '#/definitions/brief_user_info'
      kpi:
        $ref: '#/definitions/kpi'
  brief_user_info:
    type: object
    required:
      - id
      - email
      - nick_name
      - departments
    properties:
      id:
        type: integer
        description: user resource id
      email:
        type: string
        format: email
        description: user email
      nick_name:
        type: string
        description: the nick name of the user
      departments:
        type: array
        items:
          $ref: '#/definitions/user_on_department'
  user_groups:
    type: object
    required:
      - id
      - name
      - users
    properties:
      id:
        type: integer
        description: the unique user group
      name:
        type: string
        description: the unique list name
      users:
        description: the user_ids in the list
        type: array
        items:
          type: string
  brief_kpi_properties_info:
    type: object
    required:
      - id
      - name
      - type
    properties:
      id:
        type: integer
        description: the unique kpi property
      name:
        type: string
        description: the kpi property name
      type:
        type: string
        description: kpi property type
  brief_kpi_assigned_list:
    type: object
    required:
      - assignment_id
      - user
      - department_id
      - time
      - frequency
      - auto_notification
    properties:
      assignment_id:
        type: string
        description: assignment id
      user:
        $ref: '#/definitions/brief_user_info'
      department_id:
        type: string
        description: the department id to assign
      time:
        type: string
        description: the time string to remind the user to finish the task
      frequency:
        type: string
        description: the frequency to input the KPI
        enum:
          - hour
          - day
          - week
          - month
          - quater
          - year
      auto_notification:
        type: boolean
  brief_user_group_info:
    type: object
    required:
      - id
      - name
      - user_id
      - members
    properties:
      id:
        type: integer
        description: the unique user group
      name:
        type: string
        description: the unique list name
      user_id:
        type: string
        description: user group creator id
      members:
        description: the user_names in the list
        type: array
        items:
          type: string
  user_group_on_kpi:
    type: object
    required:
      - selected
      - user_group
    properties:
      selected:
        type: boolean
        description: weather the group is selected for the kpi
      user_group:
        $ref: '#/definitions/brief_user_group_info'
        description: user group
          
  kpi_detail_with_assignment:
    type: object
    required:
      - kpi
      - assignments
    properties:
      kpi:
        $ref: '#/definitions/kpi_detail'
      assignments:
        type: array
        items:
          $ref: '#/definitions/assignment'
          
  kpi_settings:
    type: object
    required:
      - kpi
      - assignments
    properties:
      kpi:
        $ref: '#/definitions/kpi'
      assignments:
        type: array
        items:
          $ref: '#/definitions/assignment'
  assignment:
    type: object
    required:
      - assignment_id
      - user
      - department_id
      - time
      - frequency
      - auto_notification
    properties:
      assignment_id:
        type: string
        description: assignment id
      user:
        type: string
        format: email
        description: user email
      department_id:
        type: string
        description: the department id to assign
      time:
        type: string
        description: the time string to remind the user to finish the task
      frequency:
        type: string
        description: the frequency to input the KPI
        enum:
          - hour
          - day
          - week
          - month
          - quater
          - year
      auto_notification:
        type: boolean
  attribute_value:
    properties:
      attribute_id:
        type: integer
        description: the attribute id
      attribute_value:
        type: string
        description: the attribute value
        
  attribute:
    type: object
    required:
      - attribute_id
      - attribute_name
      - attribute_type
      - attribute_values
    properties:
      attribute_id:
        type: integer
        description: the attribute ID
      attribute_name:
        type: string
        description: the attribute name
      attribute_type:
        type: string
        description: the type of the attributes
        enum:
          - text
          - number
          - location
      attribute_values:
        type: array
        description: the attribute values
        
        
  attributes_selection:
    type: object
    required:
      - attribute_id
      - values
    properties:
      attribute_id:
        type: integer
        description: the attribute ID
      values:
        type: array
        description: the selected attributes values
        items:
          type: string
  viewable:
    type: object
    required:
      - viewable_code
    properties:
      viewable_code:
        type: integer
        description: the viewable type
        enum:
          - public
          - private
          - partial_allow
          - partial_block
      user_group_id:
        type: integer
        description: the tagged user group
  return_message:
    type: object
    required:
      - result_code
      - messages
    properties:
      result_code:
        type: string
        description: has enum
        enum:
          - wrong password or user name
          - successfully
      messages:
        type: array
        items:
          type: string
  basic_feedback:
    type: object
    required:
      - result_code
      - need_instruction
    properties:
      result_code:
        type: string
        description: has enum
        enum:
          - wrong password or user name
          - successfully
      messages:
        type: array
        items:
          type: string
      token:
        description: OAuth token getting from the server. May expire based on the web service settings. Need to attach the token to the http head each time invoking the api
        type: string
      need_instruction:
        description: a flag to show the page id that the user has not entered in order the
        type: boolean
      customized_field:
        description: a customized field for different invoke
        type: object
  kpi_detail:
    type: object
    required:
      - kpi_id
      - kpi_name
      - description
      - creator
      - created_on
      - target_max
      - target_min
      - target_max_text
      - target_min_text
      - uom
      - calculate_method
      - frequency
      - viewable
      - attributes
    properties:
      kpi_id:
        type: string
        description: the kpi unique key
      kpi_name:
        type: string
        description: the kpi name
      description:
        type: string
        description: the description of the KPI
      creator:
        type: string
        description: "the creator's nick name"
      created_on:
        type: string
        description: the creation time in UTC format
      target_max:
        type: number
        description: the default max target
      target_min:
        type: number
        format: float
        description: the default min target
      target_max_text:
        type: string
      target_min_text:
        type: string
      uom:
        $ref: '#/definitions/enum_object'
      calculate_method:
        $ref: '#/definitions/enum_object'
      frequency:
        $ref: '#/definitions/enum_object'
      viewable:
        $ref: '#/definitions/viewable'
      attributes:
        type: array
        description: the attributes
        items:
          $ref: '#/definitions/attribute'
  kpi:
    type: object
    required:
      - kpi_id
      - kpi_name
      - description
      - creator
      - created_on
      - target_max
      - target_min
      - target_max_text
      - target_min_text
      - uom
      - calculate_method
      - frequency
      - viewable
      - attributes
    properties:
      kpi_id:
        type: string
        description: the kpi unique key
      kpi_name:
        type: string
        description: the kpi name
      description:
        type: string
        description: the description of the KPI
      creator:
        type: string
        description: "the creator's nick name"
      created_on:
        type: string
        description: the creation time in UTC format
      target_max:
        type: number
        description: the default max target
      target_min:
        type: number
        format: float
        description: the default min target
      target_max_text:
        type: string
      target_min_text:
        type: string
      uom:
        type: integer
        description: the unit of measurement code
      calculate_method:
        type: integer
        description: the calculate methode code of the kpi
      frequency:
        type: integer
      viewable:
        $ref: '#/definitions/viewable'
      attributes:
        type: array
        description: the attributes
        items:
          $ref: '#/definitions/attribute'
  department:
    type: object
    properties:
      id:
        type: integer
        description: "the department's id"
      name:
        type: string
        description: the department name
      description:
        type: string
        description: the department description
      parent_id:
        type: integer
        description: 'the parent department id, null if current department is the top department of the user'
      has_children:
        type: boolean
        description: flag to indicate whether it has chilren department
      members:
        type: arraay
        description: user nick names in the department, limit 5, can be nil
  user_on_department:
    type: object
    properties:
      managable:
        type: boolean
        description: indicate user manage rigth to the department
      department:
        $ref: '#/definitions/department'
        description: the departments
  department_follow_status:
    type: object
    required:
      - followed
      - department
      - follow_flag
      - follow_flag_value
    properties:
      followed:
        type: boolean
        description: indicate weather follow the department+kpi
      department:
        $ref: '#/definitions/department'
        description: the departments
      follow_flag:
        type: string
        description: indicate the follow status of the user to the kpi
        enum:
          - NONE
          - PARTLY
          - ALL
          - NA
      follow_flag_value:
        type: integer
        description: follow flag value
  user_kpi_on_departments:
    type: object
    required:
      - department_follow_states
      - kpi
      - user
    properties:
      user:
        $ref: '#/definitions/brief_user_info'
        description: the user
      department_follow_states:
        type: array
        items:
          $ref: '#/definitions/department_follow_status'
        description: the departments
      kpi:
        $ref: '#/definitions/kpi'
        description: the kp
  kpi_on_user:
    type: object
    required:
      - user
      - kpi
      - department
      - follow_flag
      - follow_flag_value
    properties:
      user:
        $ref: '#/definitions/brief_user_info'
        description: the user
      kpi:
        $ref: '#/definitions/kpi'
        description: the kpi desc
      department:
        $ref: '#/definitions/department'
        description: the departments
      follow_flag:
        type: string
        description: 'indicate the follow status of the user to the kpi, string to display'
      follow_flag_value:
        type: integer
        description: indicate the follow status of the user to the kpi
        enum:
          - NONE
          - PARTLY
          - ALL
          - NA
      is_created:
        type: boolean
        description: indicate whether the KPI is created by current user
      is_managable:
        type: boolean
        description: indicate whether the user has the authorization to manage the KPI
paths:
  /user_sessions:
    post:
      description: User Sign In for external app invoke
      parameters:
        - name: email
          in: query
          description: user email
          required: true
          type: string
        - name: password
          in: query
          description: user password
          required: true
          type: string
        - name: Accept-Language
          in: header
          description: 'the language code of the current user environment. zh, en, de are allowed.'
          required: true
          type: string
      responses:
        '201':
          description: Successful response
          schema:
            $ref: '#/definitions/basic_feedback'
  /user_registrations:
    post:
      description: User Sign Up Api
      parameters:
        - name: email
          in: query
          description: user email
          required: true
          type: string
        - name: password
          in: query
          description: user password
          required: true
          type: string
        - name: nick_name
          in: query
          description: user nick name
          required: true
          type: string
        - name: Accept-Language
          in: header
          description: 'the language code of the current user environment. zh, en, de are allowed.'
          required: true
          type: string
      responses:
        '201':
          description: Successful response
          schema:
            $ref: '#/definitions/return_message'
  /users/brief_infos:
    get:
      description: get user list
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: 'the oauth token from the server, type is beare'
          required: true
          type: string
        - name: page
          in: query
          type: integer
          description: 'page index of request the list, start from 0'
        - name: size
          in: query
          type: integer
          description: 'page size of request the list, default is 20'
      responses:
        '200':
          description: Successful response
          schema:
            type: array
            items:
              $ref: '#/definitions/brief_user_info'
        '403':
          description: indicate the token or user session has expired
  /users/signuped:
    post:
      description: Check user signuped
      parameters:
        - name: email
          in: query
          description: user email
          required: true
          type: string
        - name: Accept-Language
          in: header
          description: 'the language code of the current user environment. zh, en, de are allowed.'
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
      responses:
        '201':
          description: Successful response
          schema:
            $ref: '#/definitions/brief_user_info'
        '403':
          description: indicate the token or user session has expired
  /users/infos:
    get:
      description: get user account settings
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: user_id
          in: query
          type: string
          description: user account id
      responses:
        '200':
          description: Successful response
          schema:
            $ref: '#/definitions/user_info'
        '403':
          description: indicate the token or user session has expired
    post:
      description: create user account
      parameters:
        - name: user_info
          in: body
          description: user name to register
          required: true
          schema:
            $ref: '#/definitions/user_info'
        - name: password
          in: query
          description: user password
          required: true
          type: string
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
      responses:
        '201':
          description: Successful response
          schema:
            $ref: '#/definitions/basic_feedback'
    put:
      description: update user account
      parameters:
        - name: nick_name
          in: body
          description: user nick name
          required: true
          type: string
        - name: email
          in: body
          description: user email
          required: true
          type: string
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
      responses:
        '200':
          description: Successful response
          schema:
            $ref: '#/definitions/basic_feedback'
  /users/set_password:
    post:
      description: change a user password
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: old_password
          in: query
          type: string
          description: the current password
        - name: new_password
          required: true
          in: query
          type: string
          description: new password
        - name: user_id
          in: query
          type: string
          description: user to change password
      responses:
        '201':
          description: Successful response
          schema:
            $ref: '#/definitions/basic_feedback'
        '403':
          description: indicate the token or user session has expired
  /users/forget_password:
    post:
      description: user forget password api
      parameters:
        - name: email
          in: body
          description: user email
          required: true
          type: string
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
      responses:
        '201':
          description: Successful response
          schema:
            $ref: '#/definitions/return_message'
        '403':
          description: indicate the token or user session has expired
  /departments:
    get:
      description: get department
      parameters:
        - name: id
          in: query
          description: department id
          required: true
          type: integer
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
      responses:
        '200':
          description: Successful response
          schema:
            $ref: '#/definitions/department'
        '403':
          description: indicate the token or user session has expired
    post:
      description: create department
      parameters:
        - name: name
          in: body
          description: department name
          required: true
          type: string
        - name: description
          in: body
          description: department description
          required: true
          type: string
        - name: parent_id
          in: body
          description: department parent id
          required: true
          type: integer
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
      responses:
        '201':
          description: Successful response
          schema:
            $ref: '#/definitions/basic_feedback'
        '403':
          description: indicate the token or user session has expired
    put:
      description: update department
      parameters:
        - name: name
          in: body
          description: department name
          required: true
          type: string
        - name: description
          in: body
          description: department description
          required: true
          type: string
        - name: id
          in: body
          description: department id
          required: true
          type: integer
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
      responses:
        '200':
          description: Successful response
          schema:
            $ref: '#/definitions/basic_feedback'
        '403':
          description: indicate the token or user session has expired
    delete:
      description: deelte department
      parameters:
        - name: id
          in: query
          description: department id
          required: true
          type: integer
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
      responses:
        '200':
          description: Successful response
          schema:
            $ref: '#/definitions/return_message'
        '403':
          description: indicate the token or user session has expired
  /departments/add_users:
    post:
      description: add users to department with user emails
      parameters:
        - name: id
          in: body
          required: true
          type: integer
          description: department id
        - name: emails
          required: true
          in: body
          type: array
          description: user emails
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
      responses:
        '201':
          description: Successful response
          schema:
            $ref: '#/definitions/return_message'
        '403':
          description: indicate the token or user session has expired
  /departments/remove_user:
    post:
      description: remove user from the department
      parameters:
        - name: id
          in: body
          required: true
          type: integer
          description: department id
        - name: user_id
          required: true
          in: body
          type: integer
          description: user id
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
      responses:
        '201':
          description: Successful response
          schema:
            $ref: '#/definitions/return_message'
        '403':
          description: indicate the token or user session has expired
  /users/departments:
    get:
      description: get all the departments the user has access on one level.
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: department_id
          in: query
          type: integer
          description: 'the parent department ID. If the department ID is not passed, return the top level of departments'
      responses:
        '200':
          description: Successful response
          schema:
            type: array
            items:
              $ref: '#/definitions/user_on_department'
        '403':
          description: indicate the token or user session has expired
  /departments/members:
    get:
      description: get all the members of a departmment node
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: id
          in: query
          type: integer
          description: department to get the members
      responses:
        '200':
          description: Successful response
          schema:
            type: array
            items:
              $ref: '#/definitions/department_member'
        '403':
          description: indicate the token or user session has expired
  /departments/set_manager:
    post:
      description: set a user as department manager
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: id
          in: query
          type: integer
          required: true
          description: department need to set manager
        - name: user_id
          in: query
          type: integer
          required: true
          description: manager to be
      responses:
        '201':
          description: Successful response
          schema:
            $ref: '#/definitions/return_message'
        '403':
          description: indicate the token or user session has expired
  /departments/remove_manager:
    post:
      description: unset a user from department manager
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: id
          in: query
          type: integer
          required: true
          description: department need to set manager
        - name: user_id
          in: query
          type: integer
          required: true
          description: manager to be
      responses:
        '201':
          description: Successful response
          schema:
            $ref: '#/definitions/return_message'
        '403':
          description: indicate the token or user session has expired
  /kpis/unit_of_measurements:
    get:
      description: get the list
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
      responses:
        '200':
          description: successful
          schema:
            type: array
            items:
              $ref: '#/definitions/enum_object'
        '403':
          description: indicate the token or user session has expired
  /kpis/calculate_methods:
    get:
      description: get the list
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
      responses:
        '200':
          description: successful
          schema:
            type: array
            items:
              $ref: '#/definitions/enum_object'
        '403':
          description: indicate the token or user session has expired
  /kpis/timing_frequencies:
    get:
      description: get the list
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
      responses:
        '200':
          description: successful
          schema:
            type: array
            items:
              $ref: '#/definitions/enum_object'
        '403':
          description: indicate the token or user session has expired
  /kpis/users/accesses:
    get:
      description: get all the kpis the user has access.
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: page
          in: query
          type: integer
          description: 'page index of request the list, start from 0'
        - name: size
          in: query
          type: integer
          description: 'page size of request the list, default is 20'
      responses:
        '200':
          description: Successful response
          schema:
            type: array
            items:
              $ref: '#/definitions/kpi_on_user'
        '403':
          description: indicate the token or user session has expired
  /kpis/users/followed:
    get:
      description: get followed KPI by current user
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: page
          in: query
          type: integer
          description: 'page index of request the list, start from 0'
        - name: size
          in: query
          type: integer
          description: 'page size of request the list, default is 20'
      responses:
        '200':
          description: successful
          schema:
            type: array
            items:
              $ref: '#/definitions/kpi_on_user'
        '403':
          description: indicate the token or user session has expired
  /kpis/users/created:
    get:
      description: get created KPI by current user
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: page
          in: query
          type: integer
          description: 'page index of request the list, start from 0'
        - name: size
          in: query
          type: integer
          description: 'page size of request the list, default is 20'
      responses:
        '200':
          description: successful
          schema:
            type: array
            items:
              $ref: '#/definitions/kpi_on_user'
        '403':
          description: indicate the token or user session has expired
  /kpis/users/followed_details:
    get:
      description: get followed KPI details by current user
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: page
          in: query
          type: integer
          description: 'page index of request the list, start from 0'
        - name: size
          in: query
          type: integer
          description: 'page size of request the list, default is 20'
      responses:
        '200':
          description: successful
          schema:
            type: array
            items:
              $ref: '#/definitions/followed_kpi'
        '403':
          description: indicate the token or user session has expired
  /kpis/users/followed_detail_info:
    get:
      description: get followed KPI details by current user
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: follow_id
          in: query
          type: integer
          description: user follow kpi id
      responses:
        '200':
          description: successful
          schema:
            $ref: '#/definitions/followed_kpi'
        '403':
          description: indicate the token or user session has expired
  /kpis/follows:
    get:
      description: get followed KPI details by current user
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: id
          in: query
          type: integer
          description: user follow id
      responses:
        '200':
          description: successful
          schema:
            $ref: '#/definitions/followed_kpi'
        '403':
          description: indicate the token or user session has expired
  /alerts/kpi_follows/latest:
    get:
      description: get followed kpi notify
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: id
          in: query
          type: integer
          description: user follow id
      responses:
        '200':
          description: successful
          schema:
            $ref: '#/definitions/kpi_follow_alert'
        '403':
          description: indicate the token or user session has expired
  /kpis/departments:
    get:
      description: get department in the access of the user
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: kpi_id
          in: query
          description: kpi id
          required: true
          type: string
        - name: department_id
          in: query
          description: 'the start department id, if null, return the top levels of departments of the user access'
          required: true
          type: string
      responses:
        '200':
          description: ok
          schema:
            $ref: '#/definitions/user_kpi_on_departments'
        '403':
          description: indicate the token or user session has expired
  /kpis/follow:
    post:
      description: follow a kpi under certain department
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: kpi_id
          description: the kpi id to follow
          in: query
          required: true
          type: string
        - name: department_id
          in: query
          description: the department to follow
          required: true
          type: string
        - name: lower_boundary
          in: query
          description: the lower boundary for notification
          required: true
          type: number
          format: float
        - name: upper_boundary
          in: query
          description: the upper boundary for notification
          required: true
          type: number
          format: float
        - name: auto_notification
          in: query
          description: "whether receive auto notification for this following when the kpi is abnormal(exceed the upper and lower boundary's value)"
          required: true
          type: boolean
      responses:
        '201':
          description: successful
          schema:
            $ref: '#/definitions/return_message'
        '403':
          description: indicate the token or user session has expired
  /kpis/unfollow:
    post:
      description: unfollow a kpi under certain department
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: kpi_id
          description: the kpi id to unfollow
          in: query
          required: true
          type: string
        - name: department_id
          in: query
          description: the department to unfollow
          required: true
          type: string
      responses:
        '201':
          description: successful
          schema:
            $ref: '#/definitions/return_message'
        '403':
          description: indicate the token or user session has expired
  /kpis:
    get:
      description: get a kpi with an ID
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: kpi_id
          in: query
          required: true
          type: string
      responses:
        '200':
          description: successful
          schema:
            $ref: '#/definitions/kpi_detail_with_assignment'
        '403':
          description: indicate the token or user session has expired
    post:
      description: create a kpi
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: kpi
          in: body
          description: the kpi to create.
          required: true
          schema:
            $ref: '#/definitions/kpi_settings'
      responses:
        '201':
          description: successful
          schema:
            $ref: '#/definitions/basic_feedback'
        '403':
          description: indicate the token or user session has expired
    put:
      description: update a kpi
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: kpi
          in: body
          description: the kpi name to create.
          required: true
          schema:
            $ref: '#/definitions/kpi_settings'
      responses:
        '200':
          description: successful
          schema:
            $ref: '#/definitions/basic_feedback'
        '403':
          description: indicate the token or user session has expired
  /kpis/properties:
    get:
      description: get the kpi properties list
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: kpi_id
          in: body
          type: integer
          description: the kpi id
          required: true
      responses:
        '200':
          description: Successful response
          schema:
            type: array
            items:
              $ref: '#/definitions/brief_kpi_properties_info'
        '403':
          description: indicate the token or user session has expired
    post:
      description: add the kpi properties
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: kpi_id
          in: body
          type: integer
          description: the kpi id
          required: true
        - name: name
          in: body
          type: string
          description: the property name
          required: true
        - name: type
          in: body
          type: string
          description: the property type
          required: true
      responses:
        '201':
          description: successful
          schema:
            $ref: '#/definitions/basic_feedback'
        '403':
          description: indicate the token or user session has expired
    put:
      description: update the kpi properties
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: kpi_id
          in: query
          type: integer
          description: the kpi id
          required: true
        - name: property_id
          in: body
          type: integer
          description: the property id
          required: true
        - name: name
          in: body
          type: string
          description: the property name
          required: true
        - name: type
          in: body
          type: string
          description: the property type
          required: true
      responses:
        '200':
          description: successful
          schema:
            $ref: '#/definitions/basic_feedback'
        '403':
          description: indicate the token or user session has expired
  /kpis/assigns:
    get:
      description: get the kpi assigned list
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: kpi_id
          in: query
          type: integer
          description: the kpi id
          required: true
      responses:
        '200':
          description: Successful response
          schema:
            type: array
            items:
              $ref: '#/definitions/brief_kpi_assigned_list'
        '403':
          description: indicate the token or user session has expired
    post:
      description: get the kpi assigned list
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: kpi_id
          in: body
          type: integer
          description: the kpi id
          required: true
        - name: assigns
          in: body
          description: the add assigns detail
          required: true
          type: array
          items:
            $ref: '#/definitions/assignment'
      responses:
        '201':
          description: Successful response
          schema:
            $ref: '#/definitions/basic_feedback'
        '403':
          description: indicate the token or user session has expired
    delete:
      description: delete the kpi assigned record
      parameters:
        - name: assignment_id
          in: body
          type: integer
          description: the assigned id
          required: true
      responses:
        '200':
          description: Successful response
          schema:
            $ref: '#/definitions/return_message'
        '403':
          description: indicate the token or user session has expired
  /user_groups:
    post:
      description: create a user group list
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: user_group_list
          in: body
          description: the user group list object to create
          required: true
          schema:
            $ref: '#/definitions/user_groups'
      responses:
        '201':
          description: successful
          schema:
            $ref: '#/definitions/basic_feedback'
        '403':
          description: indicate the token or user session has expired
    put:
      description: update a user group list
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: user_groups
          in: body
          description: the user group list object to update
          required: true
          schema:
            $ref: '#/definitions/user_groups'
      responses:
        '200':
          description: successful
          schema:
            $ref: '#/definitions/basic_feedback'
        '403':
          description: indicate the token or user session has expired
    get:
      description: get a user group list
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: id
          in: query
          description: the user group id
          required: true
          type: string
      responses:
        '200':
          description: successful
          schema:
            type: array
            items:
              $ref: '#/definitions/user_groups'
        '403':
          description: indicate the token or user session has expired
  /user_groups/for_kpis:
    get:
      description: get the user list with full text method
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: kpi_id
          in: query
          description: kpi id
          required: true
          type: string
      responses:
        '200':
          description: Successful response
          schema:
            type: array
            items:
              $ref: '#/definitions/user_group_on_kpi'
        '403':
          description: indicate the token or user session has expired
  /search/full_text/users:
    get:
      description: get the user list with full text method
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: input_chars
          in: query
          type: string
          description: the characters the user input
      responses:
        '200':
          description: Successful response
          schema:
            type: array
            items:
              $ref: '#/definitions/brief_user_info'
        '403':
          description: indicate the token or user session has expired
  /search/full_text/departments:
    get:
      description: get the department list with full text method
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: input_chars
          in: query
          type: string
          description: the characters the user input
      responses:
        '200':
          description: Successful response
          schema:
            type: array
            items:
              $ref: '#/definitions/department'
        '403':
          description: indicate the token or user session has expired
  /search/full_text/kpis:
    get:
      description: "get the user's followable kpi list with full text method"
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: input_chars
          in: query
          type: string
          description: the characters the user input
      responses:
        '200':
          description: Successful response
          schema:
            type: array
            items:
              $ref: '#/definitions/kpi_on_user'
        '403':
          description: indicate the token or user session has expired
  /search/full_text/followed_kpis:
    get:
      description: "get the user's following kpi list with full text method"
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: input_chars
          in: query
          type: string
          description: the characters the user input
      responses:
        '200':
          description: Successful response
          schema:
            type: array
            items:
              $ref: '#/definitions/followed_kpi'
        '403':
          description: indicate the token or user session has expired
  /discussions:
    get:
      description: get the discussion by ID
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: id
          in: query
          required: true
          type: string
          description: the discussion id
      responses:
        '200':
          description: Successful response
          schema:
            $ref: '#/definitions/discussion'
        '403':
          description: indicate the token or user session has expired
    post:
      description: create a discussion
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: title
          in: body
          type: string
          description: the discussion title
          required: true
        - name: kpi_id
          in: body
          type: string
          description: the kpi id
          required: true
        - name: department_id
          in: body
          type: string
          description: the department id
          required: true
        - name: members
          in: body
          required: true
          type: array
          items:
            type: string
            description: array of user id of the members
        - name: content
          in: body
          type: string
          description: the discussion content
          required: true
      responses:
        '201':
          description: Successful response
          schema:
            $ref: '#/definitions/basic_feedback'
        '403':
          description: indicate the token or user session has expired
  /discussions/resolve:
    post:
      description: create a discussion
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: id
          in: body
          type: string
          description: the discussion id
          required: true
      responses:
        '201':
          description: Successful response
          schema:
            $ref: '#/definitions/discussion'
        '403':
          description: indicate the token or user session has expired
  /discussions/users/accesses:
    get:
      description: get the all discussions list
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: id
          in: query
          required: true
          type: integer
          description: the kpi id
        - name: relevant
          in: query
          required: false
          type: boolean
          description: the relavent flag
        - name: page
          in: query
          type: integer
          description: 'page index of request the list, start from 0'
        - name: size
          in: query
          type: integer
          description: 'page size of request the list, default is 20'
      responses:
        '200':
          description: Successful response
          schema:
            type: array
            items:
              $ref: '#/definitions/discussion'
        '403':
          description: indicate the token or user session has expired
  /discussions/users/created:
    get:
      description: get the discussions list by current user
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: id
          in: query
          required: true
          type: integer
          description: the kpi id
        - name: page
          in: query
          type: integer
          description: 'page index of request the list, start from 0'
        - name: size
          in: query
          type: integer
          description: 'page size of request the list, default is 20'
      responses:
        '200':
          description: Successful response
          schema:
            type: array
            items:
              $ref: '#/definitions/discussion'
        '403':
          description: indicate the token or user session has expired
  /discussions/members/as_select:
    get:
      description: get the member list of a discussion
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: id
          in: query
          required: true
          description: the discussion id
          type: string
      responses:
        '200':
          description: Successful response
          schema:
            type: array
            items:
              $ref: '#/definitions/brief_user_info'
        '403':
          description: indicate the token or user session has expired
  /discussions/members:
    get:
      description: get the member list of a discussion
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: id
          in: query
          required: true
          description: the discussion id
          type: string
      responses:
        '200':
          description: Successful response
          schema:
            type: array
            items:
              $ref: '#/definitions/users_on_discussion'
        '403':
          description: indicate the token or user session has expired
    post:
      description: update the list of members in a discussion
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: id
          in: body
          description: discussion id
          required: true
          type: integer
        - name: user_id
          in: body
          description: member id
          required: true
          type: integer
      responses:
        '201':
          description: Successful response
          schema:
            $ref: '#/definitions/users_on_discussion'
        '403':
          description: indicate the token or user session has expired
    delete:
      description: remove the discussion member
      parameters:
        - name: id
          in: body
          type: integer
          description: the discussion id
          required: true
        - name: member_id
          in: body
          type: integer
          description: the member id
          required: true
      responses:
        '200':
          description: Successful response
          schema:
            $ref: '#/definitions/return_message'
        '403':
          description: indicate the token or user session has expired
  /discussions/members/add_multiple:
    post:
      description: update the list of members in a discussion
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: id
          in: body
          description: discussion id
          required: true
          type: integer
        - name: user_ids
          in: body
          description: member ids
          required: true
          type: array
          items:
            type: integer
            description: array of user id of the members
      responses:
        '201':
          description: Successful response
          schema:
            $ref: '#/definitions/users_on_discussion'
        '403':
          description: indicate the token or user session has expired
  /discussions/comments:
    get:
      description: get comments of a discussion
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: id
          in: query
          description: the discussion id of the comments
          type: string
        - name: page
          in: query
          type: integer
          description: 'page index of request the list, start from 0'
        - name: size
          in: query
          type: integer
          description: 'page size of request the list, default is 20'
      responses:
        '200':
          description: Successful response
          schema:
            type: array
            items:
              $ref: '#/definitions/comment'
        '403':
          description: indicate the token or user session has expired
    post:
      description: add a comment to a discussion
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: id
          in: body
          description: the discussion id
          type: integer
          required: true
        - name: comment
          in: body
          description: the discussion to add the comment
          required: true
          schema:
            $ref: '#/definitions/discussion_comments'
      responses:
        '201':
          description: Successful response
          schema:
            $ref: '#/definitions/basic_feedback'
        '403':
          description: indicate the token or user session has expired
  /comments:
    get:
      description: get a comment with id
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: comment_id
          in: query
          description: the discussion to add the comment
          type: string
      responses:
        '200':
          description: Successful response
          schema:
            $ref: '#/definitions/comment'
        '403':
          description: indicate the token or user session has expired
  /entries:
    post:
      description: enter a kpi data
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: task_item_id
          in: body
          required: false
          description: 'the task item id to receive the data in case the user enter the data via a task. could be null if it is a manual input, and it should not post to server'
          type: integer
        - name: data
          in: body
          required: true
          schema:
            $ref: '#/definitions/data_input'
      responses:
        '201':
          description: Successful response
          schema:
            $ref: '#/definitions/basic_feedback'
        '403':
          description: indicate the token or user session has expired
  /entries/chart_data:
    get:
      description: get chart data
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: follow_id
          in: query
          type: integer
          description: 'the follow id, if kpi id or department id is blank it is requried'
        - name: kpi_id
          in: query
          type: integer
          required: false
          description: 'the kpi id, if follow id is blank it is required'
        - name: department_id
          in: query
          type: integer
          required: false
          description: 'the department id, if follow id is blank it is required'
        - name: frequency
          in: query
          type: integer
          required: true
          description: the frequency of time span
          enum:
            - hour
            - day
            - week
            - month
            - quater
            - year
        - name: calculate_method
          in: query
          type: integer
          required: true
          description: the calculate method to summerize the data
          enum:
            - average
            - accumulate
        - name: from_time
          in: query
          type: datetime
          required: true
          description: 'the start point of the time span, utc'
          format: date-time
        - name: end_time
          in: query
          type: datetime
          required: true
          description: 'the end point of the time span, utc'
          format: date-time
        - name: attributes
          in: query
          description: 'need pass attribute values to server, if attribute id is passed'
          schema:
            type: array
            items:
              $ref: '#/definitions/attributes_selection'
      responses:
        '200':
          description: Successful response
          schema:
            type: array
            items:
              $ref: '#/definitions/chart_data'
        '403':
          description: indicate the token or user session has expired
  /entries/chart_aggregate_data:
    get:
      description: make an aggregative analysis
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: follow_id
          in: query
          type: integer
          description: 'the follow id, if kpi id or department id is blank it is requried'
        - name: kpi_id
          in: query
          type: integer
          required: false
          description: 'the kpi id, if follow id is blank it is required'
        - name: department_id
          in: query
          type: integer
          required: false
          description: 'the department id, if follow id is blank it is required'
        - name: frequency
          in: query
          type: integer
          required: true
          description: the frequency of time span
          enum:
            - hour
            - day
            - week
            - month
            - quater
            - year
        - name: calculate_method
          in: query
          type: integer
          required: true
          description: the calculate method to summerize the data
          enum:
            - average
            - accumulate
        - name: from_time
          in: query
          type: datetime
          required: true
          description: 'the start point of the time span, utc'
          format: date-time
        - name: end_time
          in: query
          type: datetime
          required: true
          description: 'the end point of the time span, utc'
          format: date-time
        - name: attributes
          in: query
          description: donot need pass attribute values to server
          schema:
            type: array
            items:
              $ref: '#/definitions/attributes_selection'
      responses:
        '200':
          description: Successful response
          schema:
            type: array
            items:
              $ref: '#/definitions/chart_aggregate_data'
        '403':
          description: indicate the token or user session has expired
  /attachments/snapshots:
    get:
      description: get the snapshot by it
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: id
          in: query
          description: the snapshot id
          type: string
      responses:
        '200':
          description: Successful response
          schema:
            $ref: '#/definitions/snapshot'
        '403':
          description: indicate the token or user session has expired
    post:
      description: add a snapshot
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: snap
          in: body
          required: true
          description: 'the snapshot data in json'
          type: string
        - name: alert_id
          in: body
          required: true
          description: 'the akert id'
          type: integer
        - name: upper_boundary_text
          in: body
          required: true
          description: 'the current upper boundary'
          type: string
        - name: lower_boundary_text
          in: body
          required: true
          description: 'the current lower boundary'
          type: string
        - name: current_value_text
          in: body
          required: true
          description: 'the current value'
          type: string
      responses:
        '201':
          description: Successful response
          schema:
            $ref: '#/definitions/basic_feedback'
        '403':
          description: indicate the token or user session has expired
  /attachments/images:
    post:
      description: add a snapshot
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: attachments
          in: body
          required: true
          description: 'the images list'
          type: array
          items:
            type: image
            $ref: '#/definitions/image_attachs'
      responses:
        '201':
          description: Successful response
          schema:
            $ref: '#/definitions/basic_feedback'
        '403':
          description: indicate the token or user session has expired
  /attachments/image:
    post:
      description: add a snapshot
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: image
          in: body
          required: true
          description: 'the image'
          type: image
      responses:
        '201':
          description: Successful response
          schema:
            $ref: '#/definitions/basic_feedback'
        '403':
          description: indicate the token or user session has expired
  /tasks:
    get:
      description: get task by task id
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: task_id
          in: query
          description: the task id to receive the task
          type: string
      responses:
        '200':
          description: Successful response
          schema:
            $ref: '#/definitions/task'
            description: the task with the id
        '403':
          description: indicate the token or user session has expired
  /tasks/entries/list:
    get:
      description: get user task list for entry data
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: page
          in: query
          type: integer
          description: 'page index of request the list, start from 0'
        - name: size
          in: query
          type: integer
          description: 'page size of request the list, default is 20'
      responses:
        '200':
          description: Successful response
          schema:
            type: array
            items:
              $ref: '#/definitions/brief_entry_task'
            description: the tasks the user are assigned
        '403':
          description: indicate the token or user session has expired
  /tasks/entries/items:
    get:
      description: get task items by task id
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: task_id
          in: query
          description: the task id to receive the task
          required: true
          type: integer
        - name: status
          in: query
          description: the status values of task item, like planed, default is [100], can be blank(not pass to server)
          required: false
          type: array
        - name: page
          in: query
          type: integer
          description: 'page index of request the list, start from 0'
        - name: size
          in: query
          type: integer
          description: 'page size of request the list, default is 20'
      responses:
        '200':
          description: Successful response
          schema:
            type: array
            items:
              $ref: '#/definitions/brief_entry_task_item'
        '403':
          description: indicate the token or user session has expired
  /tasks/entries/item:
    get:
      description: get task item detail by task item id
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: task_item_id
          in: query
          description: the task item id 
          required: true
          type: integer
      responses:
        '200':
          description: Successful response
          schema:
            $ref: '#/definitions/brief_entry_task_item'
        '403':
          description: indicate the token or user session has expired
  /alerts/users/counts/unread:
    get:
      description: get alerts of a user
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
      responses:
        '200':
          description: Successful response
          schema:
            type: array
            items:
              $ref: '#/definitions/unread_alert'
        '403':
          description: indicate the token or user session has expired
  /alerts/tasks:
    get:
      description: get task alerts of a user
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: page
          in: query
          type: integer
          description: 'page index of request the list, start from 0'
        - name: size
          in: query
          type: integer
          description: 'page size of request the list, default is 20'
      responses:
        '200':
          description: Successful response
          schema:
            type: array
            items:
              $ref: '#/definitions/task_alert'
        '403':
          description: indicate the token or user session has expired
  /alerts/systems:
    get:
      description: get alerts of a user
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: page
          in: query
          type: integer
          description: 'page index of request the list, start from 0'
        - name: size
          in: query
          type: integer
          description: 'page size of request the list, default is 20'
      responses:
        '200':
          description: Successful response
          schema:
            type: array
            items:
              $ref: '#/definitions/system_alert'
        '403':
          description: indicate the token or user session has expired
  /alerts/kpi_followed:
    get:
      description: get alerts of a user
      parameters:
        - name: Accept-Language
          in: header
          description: the language code of the current user environment
          required: true
          type: string
        - name: Authorization
          in: header
          description: the oauth token from the server
          required: true
          type: string
        - name: page
          in: query
          type: integer
          description: 'page index of request the list, start from 0'
        - name: size
          in: query
          type: integer
          description: 'page size of request the list, default is 20'
      responses:
        '200':
          description: Successful response
          schema:
            type: array
            items:
              $ref: '#/definitions/kpi_follow_alert'
        '403':
          description: indicate the token or user session has expired
